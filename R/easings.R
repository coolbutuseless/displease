

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#' Easing between two values
#'
#' @param x1,x2 Numeric values
#' @param n steps
#' @param type a combination of a name plus 'in', 'out' or 'in_out'. Valid names
#'        are 'sine', 'quad', 'cubic', 'quart', 'quint', 'exp', 'circle', 'back',
#'        'elastic'.  E.g. 'cubic-in-out', 'exp-in'
#'
#' @return Numeric vector of length \code{n}
#' @export
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
seq_ease <- function(x1=0, x2=1, n=100, type) {
  loc <- seq(0, 1, length.out = n)

  type <- gsub("\\s|-", "_", type)

  fac <- switch(
    type,

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Sine
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sine_in = 1 - cos((loc * pi) / 2),
    sine_out = 1 - sin((loc * pi) / 2),
    sine_in_out = -(cos(loc * pi) - 1) / 2,

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Quad
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    quad_in     = loc^2,
    quad_out    = 1 - (1 - loc)^2,
    quad_in_out = ifelse(loc < 0.5,
                         2 * loc^2,
                         1 - 0.5 * (-2 * loc + 2)^2),

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Cubic
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    cubic_in  = loc^3,
    cubic_out = 1 - (1 - loc)^3,
    cubic_in_out = ifelse(loc < 0.5,
                          4 * loc^3,
                          1 - 0.5 * (-2 * loc + 2)^3),

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Quart
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    quart_in     = loc^4,
    quart_out    = 1 - (1 - loc)^4,
    quart_in_out = ifelse(loc < 0.5,
                          8 * loc^4,
                          1 - 0.5 * (-2 * loc + 2)^4),

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Quint
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    quint_in     = loc^5,
    quint_out    = 1 - (1 - loc)^5,
    quint_in_out = ifelse(loc < 0.5,
                          16 * loc^5,
                          1 - 0.5 * (-2 * loc + 2)^5),

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Exp
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    exp_in     = 2^(10 * loc - 10),
    exp_out    = 1 - 2^(-10 * loc),
    exp_in_out = ifelse(loc == 0, 0,
                        ifelse(loc == 1, 1,
                               ifelse(loc < 0.5,
                                      2 ^ (20 * loc - 10)/2,
                                      (2 - 2^(-20 * loc + 10)) / 2
                               )
                        )
    ),

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Circle
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    circle_in     = 1 - sqrt(1 - loc^2),
    circle_out    = sqrt(1 - (loc - 1)^2),
    circle_in_out = suppressWarnings({
      ifelse(loc < 0.5,
             (1 - sqrt(1 - (2 * loc)^2)) / 2,
             0.5 * (sqrt(1 - (-2 * loc + 2)^2) + 1))
    }),

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Back
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    back_in     = 2.70158 * loc^3 - 1.70158 * loc^2,
    back_out    = 1 + 2.70158 * (loc - 1)^3 + 1.70158 * (loc - 1)^2,
    back_in_out = {
      c1 <- 1.70158
      c2 <- c1 * 1.525
      ifelse(loc < 0.5,
             (2*loc)^2 * ((c2 + 1) * 2 * loc - c2) / 2,
             ((2*loc-2)^2 * ((c2 + 1) * (loc * 2 - 2) + c2) + 2) / 2
             )
    },

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Elastic
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    elastic_in     = ifelse(
      loc == 0, 0,
      ifelse(loc == 1,
             1,
             -(2 ^ (10*loc-10)) * sin((loc * 10 - 10.75) * 2 * pi / 3)
             )
    ),
    elastic_out    = ifelse(
      loc == 0, 0,
      ifelse(loc == 1,
             1,
             2^(-10*loc) * sin((loc * 10 - 0.75) * 2 * pi / 3) + 1)
    ),
    elastic_in_out = ifelse(
      loc == 0, 0,
      ifelse(loc == 1, 1,
             ifelse(loc < 0.5,
                    -(2^( 20*loc - 10) * sin((20 * loc - 11.125) * 2 * pi/4.5)) / 2,
                     (2^(-20*loc + 10) * sin((20 * loc - 11.125) * 2 * pi/4.5)) / 2 + 1
             ))
    ),


    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Ooops!
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    stop("No such ease type: ", type)
  )

  x1 + fac * (x2 - x1)
}
